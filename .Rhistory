filter(Location %in% statesList) %>%
select(Location,ThousandBarrel) %>%
spread(Location,ThousandBarrel)
statesList = c('Alaska','California')
df = data %>%
filter(Location %in% statesList) %>%
select(Location,ThousandBarrel) %>%
spread(Location,ThousandBarrel)
df = data %>%
filter(Location %in% statesList) %>%
select(Location,ThousandBarrel) %>%
spread(Location)
df = data %>%
filter(Location %in% statesList) %>%
select(Location,ThousandBarrel) %>%
spread(Location,Location)
df = data %>%
filter(Location %in% statesList) %>%
select(Location,ThousandBarrel)
head(df)
spread(df,Location,ThousandBarrel)
spread(df,ThousandBarrel,Location)
spread(df,a,b)
spread(df,Location,b)
spread(df,ThousandBarrel,Location)
spread(df,Location,b)
spread(df,ThousandBarrel,Location)
spread(df,Location,ThousandBarrel)
df = data %>%
filter(Location %in% statesList)
head(df)
qplot
spread(df,ThousandBarrel,Location)
spread(df,ThousandBarrel,Location)
df = data %>%
filter(Location %in% statesList) %>%
select(Location,ThousandBarrel)
spread(df,ThousandBarrel,Location)
head(df)
nrow(df)
tail(df)
df = data %>%
filter(Location %in% statesList)
df = data %>%
filter(Location %in% statesList) %>%
spread(Location,ThousandBarrel)
df
head(df)
df = data %>%
filter(Location %in% statesList) %>%
spread(Location,ThousandBarrel) %>%
select(Alaska,California)
df
df = data %>%
filter(Location %in% statesList) %>%
spread(Location,ThousandBarrel) %>%
select(Alaska,California)
p = qplot(Alaska, California, data = df)
p
p + scale_y_continuous(labels = comma)
p + scale_y_continuous(labels = comma)
p = ggplot(df,aes(x=Alaska,y=California))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Oil Production 1981-2016 AK vs. CA') +
theme(plot.title = element_text(hjust = 0.5))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Oil Production 1981-2016 AK vs. CA') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth()
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Oil Production 1981-2016 AK vs. CA') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
p = ggplot(df,aes(x=Alaska,y=California,col=Year))
df = data %>%
filter(Location %in% statesList) %>%
spread(Location,ThousandBarrel) %>%
select(Alaska,California,Year)
p = ggplot(df,aes(x=Alaska,y=California,col=Year))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Thousand Barrel Oil Production 1981-2016 CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Thousand Barrel Oil Production 1981-2016 CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Thousand Barrel Oil Production 1981-2016 CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
p = ggplot(df,aes(x=Alaska,y=California))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Monthly Thousand Barrel Oil Production 1981-2016 CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
df = data %>%
filter(Location %in% statesList) %>%
spread(Location,ThousandBarrel) %>%
select(Alaska,California,Month)
p = ggplot(df,aes(x=Alaska,y=California,col=Month))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Oil Production - CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5))
df = data %>%
filter(Location %in% statesList) %>%
spread(Location,ThousandBarrel) %>%
select(Alaska,California,Month,Year)
p = ggplot(df,aes(x=Alaska,y=California,col=Month,fill=Year))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Oil Production - CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5))
p = ggplot(df,aes(x=Alaska,y=California,col=Month,size=Year))
p + geom_point() +
scale_y_continuous(labels = comma) +
scale_x_continuous(labels = comma) +
ggtitle('Oil Production - CA vs. AK') +
theme(plot.title = element_text(hjust = 0.5))
df = data %>%
group_by(Year,Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel))
p = ggplot(df,aes(x=Location,y=ThousandBarrel))
p + geom_boxplot()
p + geom_boxplot() +
ggtitle('Distributions of Oil Production by State')
p + geom_boxplot() +
ggtitle('Distribution of Oil Production by State') +
coord_flip()
p = ggplot(df,aes(x=reorder(Location,ThousandBarrel),y=ThousandBarrel))
p + geom_boxplot() +
ggtitle('Distribution of Oil Production by State') +
coord_flip()
p + geom_boxplot() +
scale_y_continuous(labels = comma) +
ggtitle('Distribution of Annual Oil Production By State (1981 - 2016)') +
coord_flip()
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel))
pie
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = ThousandBarrel()) %>%
mutate(freq = n / sum(n))
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = n()) %>%
mutate(freq = n / sum(n))
df = data %>%
group_by(Location) %>%
summarise(n = sum(ThousandBarrel) %>%
mutate(freq = n / sum(n))
)
df = data %>%
group_by(Location) %>%
summarise(n = sum(ThousandBarrel)) %>%
mutate(freq = n / sum(n))
df
tail(df)
df = data %>%
group_by(Location) %>%
summarise(tb = ThousandBarrel()) %>%
mutate(freq = tb / sum(tb))
df = data %>%
group_by(Location) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel))
df
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df = data %>%
>>
df
sum(df$ThousandBarrel)
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = round(ThousandBarrel/sum(ThousandBarrel)),0)
df
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,0)
df
tail(df)
head(df)
sum(df$ThousandBarrel)
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
sum(df$ThousandBarrel)
df$ThousandBarrel = round(df$ThousandBarrel,2)
sum(df$ThousandBarrel)
df
df$ThousandBarrel = round(100*df$ThousandBarrel,0)
head(df)
df$ThousandBarrel = round(df$ThousandBarrel,2)
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,2)
head(df)
tail(df)
pie(df)
head(df)
pie(df,labels=Location)
pie(df,x=ThousandBarrel,labels=Location)
pie(df,x='ThousandBarrel',labels='Location')
pie(df$ThousandBarrel,df$Location)
pie3D(df$ThousandBarrel,df$Location,explode=0.1,col=rainbow(nrow(df)))
install.packages('plotrix')
library(plotrix)
pie3D(df$ThousandBarrel,df$Location,explode=0.1,col=rainbow(nrow(df)))
nrow(df)
pie3D(df$ThousandBarrel,labels=df$Location,explode=0.1,col=rainbow(nrow(df)))
rainbow(nrow(df))
pie3D(df$ThousandBarrel,labels=df$Location,col=rainbow(nrow(df)))
help("pie3D")
df = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(100*df$ThousandBarrel,0)
pie3D(x=df$ThousandBarrel,labels=df$Location,explode=0.1,col=rainbow(nrow(df)))
pie(x=df$ThousandBarrel,labels=df$Location,explode=0.1,col=rainbow(nrow(df)))
help(pie)
pie(x=df$ThousandBarrel,labels=df$Location,explode=0.1,col=rainbow(nrow(df)),main='Percentage of Oil Production by State')
df
data$decade = '1980s'
data$decade[data$Year >= 1990] = '1990s'
data$decade[data$Year >= 2000] = '2000s'
data$decade[data$Year >= 2010] = '2010s'
data$decade = as.factor(data$decade)
df = data %>%
group_by(Decade,Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
head(data)
data$Decade = '1980s'
data$Decade[data$Year >= 1990] = '1990s'
data$Decade[data$Year >= 2000] = '2000s'
data$Decade[data$Year >= 2010] = '2010s'
data$Decade = as.factor(data$Decade)
df = data %>%
group_by(Decade,Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
head(decade)
head(data)
df
sum(df$ThousandBarrel)
df = data %>%
group_by(Decade,Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(100*df$ThousandBarrel,0)
df
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=Location,fill=Location))
p + geom_bar()
p + geom_bar(stat='identity')
df$ThousandBarrel = round(100*df$ThousandBarrel,1)
df = data %>%
group_by(Decade,Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,3)
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=Location,fill=Location))
p + geom_bar(stat='identity')
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(Location,ThousandBarrel),fill=reorder(Location,ThousandBarrel)))
p + geom_bar(stat='identity')
top10 = df %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
arrange(-ThousandBarrel)
top10 = df %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
arrange(-ThousandBarrel) %>%
top_n(10)
top10
top10 = df %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
arrange(-ThousandBarrel) %>%
top_n(10) %>%
select(Location)
top10
top10List = list(top10)
top10List
top10List = top10$Location
top10List
df$State = "Other"
for(i in 1:length(top10List)){
df$State[df$Location == top10List[i]] = top10List[i]
}
head(top10List)
head(df)
data$State = "Other"
for(i in 1:length(top10List)){
data$State[data$Location == top10List[i]] = top10List[i]
}
top10 = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
arrange(-ThousandBarrel) %>%
top_n(10) %>%
select(Location)
top10List = top10$Location
top10List
head(data)
tail(data)
unique(data$State)
df = data %>%
group_by(Decade,State) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,3)
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity')
data$State = ".Other"
for(i in 1:length(top10List)){
data$State[data$Location == top10List[i]] = top10List[i]
}
df = data %>%
group_by(Decade,State) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,3)
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity')
data$State = "0ther"
for(i in 1:length(top10List)){
data$State[data$Location == top10List[i]] = top10List[i]
}
df = data %>%
group_by(Decade,State) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,3)
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity')
data$State = "Other"
for(i in 1:length(top10List)){
data$State[data$Location == top10List[i]] = top10List[i]
}
df = data %>%
group_by(Decade,State) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,3)
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity')
top5 = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
arrange(-ThousandBarrel) %>%
top_n(5) %>%
select(Location)
top10List = top10$Location
data$State = "Other"
for(i in 1:length(top5List)){
data$State[data$Location == top10List[i]] = top10List[i]
}
top5 = data %>%
group_by(Location) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
arrange(-ThousandBarrel) %>%
top_n(5) %>%
select(Location)
top5List = top5$Location
data$State = "Other"
for(i in 1:length(top5List)){
data$State[data$Location == top5List[i]] = top5List[i]
}
df = data %>%
group_by(Decade,State) %>%
summarise(ThousandBarrel = sum(ThousandBarrel)) %>%
mutate(ThousandBarrel = ThousandBarrel/sum(ThousandBarrel))
df$ThousandBarrel = round(df$ThousandBarrel,3)
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity')
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top 5 Oil Producing States by Decade')
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top 5 Oil Producing States by Decade') +
coord_flip()
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top 5 Oil Producing States by Decade')
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top 5 Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'))
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top 5 Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State'))
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top 5 Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=ThousandBarrel)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=ThousandBarrel),col='Black') +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=ThousandBarrel),col='Black',size = 3, hjust = 0.5, vjust = 3, position ="stack") +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=ThousandBarrel),col='Black',size = 3, hjust = 0.5, vjust = 3, position = position_stack(vjust = 0.5)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
df$text = paste(df$ThousandBarrel,'%', sep='')
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 3, hjust = 0.5, vjust = 3, position = position_stack(vjust = 0.5)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
df$text = paste(round(100*df$ThousandBarrel,0),'%', sep='')
p = ggplot(df,aes(x=Decade,y=ThousandBarrel,col=reorder(State,ThousandBarrel),fill=reorder(State,ThousandBarrel)))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 3, hjust = 0.5, vjust = 3, position = position_stack(vjust = 0.5)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 6, hjust = 0.5, vjust = 3, position = position_stack(vjust = 0.5)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 4, hjust = 0.5, vjust = 3, position = position_stack(vjust = 0.5)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 4, hjust = 0.5, vjust = 3, position = position_stack(vjust = 0.2)) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 4, hjust = 0.5, vjust = 3, position = "stack") +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
help(geom_text)
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 4, hjust = 0.5, vjust = 3) +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
p + geom_bar(stat='identity') +
geom_text(aes(label=text),col='Black',size = 4, hjust = 0.5, vjust = 3, position = "stack") +
scale_y_continuous(labels = percent) +
ggtitle('Percentage of Top Oil Producing States by Decade') +
guides(fill=guide_legend(title='State'),col=guide_legend(title='State')) +
theme(plot.title = element_text(hjust = 0.5))
